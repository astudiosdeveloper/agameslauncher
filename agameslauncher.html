<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Launcher</title>
<style>
  html, body { margin:0; padding:0; width:100%; height:100%; overflow:hidden; background:black; }
  canvas { outline:none; cursor:none; }
</style>
</head>
<body class="dark">

<button id="launchBtn" style="position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);padding:20px 40px;font-size:20px;">Play Fullscreen</button>

<script>
document.getElementById('launchBtn').addEventListener('click', () => {
    // Open about:blank to hide URLs
    const win = window.open('about:blank', '_self');

    win.document.write(`
<!DOCTYPE html>
<html lang="en-us">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contra</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/sel-lers/x@main/style.css">
<style>
  html, body { margin:0; padding:0; width:100%; height:100%; overflow:hidden; background:black; }
  canvas { outline:none; cursor:none; }
  /* Ad container styles */
  #ad-container { position:fixed; top:0; left:50%; transform:translateX(-50%); width:min(728px,calc(100%-20px)); height:90px; background:rgba(0,0,0,0.9); display:none; z-index:99999; border-radius:0; overflow:hidden; box-shadow:0 2px 12px rgba(0,0,0,0.45); box-sizing:border-box; transition:transform 0.5s ease-in-out; }
  #ad-container.hidden { transform:translate(-50%,-100%); }
  #ad-iframe { position:absolute; top:0; left:50%; transform:translateX(-50%); width:745px; height:90px; border:0; display:block; overflow:hidden; pointer-events:auto; }
  #close-ad { position:absolute; top:6px; right:8px; background:#ff4d4d; color:#fff; border:none; padding:5px 9px; font-size:13px; border-radius:4px; cursor:not-allowed; opacity:0.72; z-index:100000; display:flex; align-items:center; }
  #close-ad.enabled { cursor:pointer; opacity:1; }
  #close-ad::before { content:'↑'; margin-right:4px; }
  #ad-right-mask { position:absolute; top:0; right:0; width:12px; height:100%; pointer-events:none; background:linear-gradient(to right, rgba(0,0,0,0), rgba(0,0,0,0.9)); z-index:99999; }
</style>
</head>
<body>

<div id="unity-container" class="unity-desktop">
<canvas id="unity-canvas" tabindex="-1" width="811" height="647"></canvas>
</div>

<div id="loading-cover" style="background:url('https://cdn.jsdelivr.net/gh/sel-lers/x@main/background.jpg') center / cover; display:none;">
  <div id="unity-loading-bar">
    <div id="unity-logo"><img src="https://cdn.jsdelivr.net/gh/sel-lers/x@main/logo.png"></div>
    <div id="unity-progress-bar-empty">
      <div id="unity-progress-bar-full" style="width:100%;"></div>
    </div>
    <div class="spinner" style="display:none;"></div>
  </div>
</div>

<!-- Google Ads -->
<div id="ad-container" aria-hidden="false" role="dialog" aria-label="Advertisement" style="display:block;">
  <iframe id="ad-iframe" src="https://script.google.com/macros/s/AKfycbzA6GNdpfUShkCh6apD0D21YAUf7A5d3Guhq2PayqLbk_5XG_wQhy0bdYzKJWLhzgMVMQ/exec" width="768" height="95" scrolling="no" frameborder="0" sandbox="allow-scripts allow-popups allow-same-origin"></iframe>
  <button id="close-ad" class="enabled">Close ↑</button>
  <div id="ad-right-mask"></div>
</div>

<script>
  const canvas = document.getElementById('unity-canvas');
  const loadingCover = document.getElementById('loading-cover');
  const progressBarFull = document.getElementById('unity-progress-bar-full');
  const spinner = document.querySelector('.spinner');

  // Unity config
  const buildUrl = "https://cdn.jsdelivr.net/gh/sel-lers/x@main/Build";
  const loaderUrl = buildUrl + "/Web GL.loader.js";
  const config = {
    dataUrl: buildUrl + "/Web GL.data.unityweb",
    frameworkUrl: buildUrl + "/Web GL.framework.js.unityweb",
    codeUrl: buildUrl + "/Web GL.wasm.unityweb",
    streamingAssetsUrl: "StreamingAssets",
    companyName: "FoXSkr",
    productName: "Contra",
    productVersion: "1.9.4"
  };

  // Load Unity
  const script = document.createElement("script");
  script.src = loaderUrl;
  script.onload = () => {
    createUnityInstance(canvas, config, (progress) => {
      spinner.style.display="none";
      progressBarFull.style.width = (100*progress) + "%";
    }).then((unityInstance) => {
      // Request fullscreen & pointer lock on click
      canvas.addEventListener('click', () => {
        canvas.requestFullscreen?.();
        canvas.requestPointerLock?.();
      });
      loadingCover.style.display = "none";
    }).catch(console.error);
  };
  document.body.appendChild(script);

  // Ad logic
  const adContainer = document.getElementById('ad-container');
  const closeBtn = document.getElementById('close-ad');
  function showAd() {
    adContainer.style.display = 'block';
    adContainer.classList.remove('hidden');
    let timeLeft = 12;
    closeBtn.textContent = \`Close (\${timeLeft})\`;
    closeBtn.disabled = true;
    closeBtn.classList.remove('enabled');
    const t = setInterval(() => {
      timeLeft--;
      if(timeLeft>0){ closeBtn.textContent=\`Close (\${timeLeft})\`; } 
      else { clearInterval(t); closeBtn.disabled=false; closeBtn.classList.add('enabled'); closeBtn.textContent='Close ↑'; }
    },1000);
  }
  setTimeout(showAd,2000);
  closeBtn.addEventListener('click',()=>{ if(closeBtn.disabled) return; adContainer.classList.add('hidden'); setTimeout(showAd,25000); });
</script>

</body>
</html>
    `);
});
</script>

</body>
</html>
